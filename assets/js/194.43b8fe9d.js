(window.webpackJsonp=window.webpackJsonp||[]).push([[194],{363:function(s,a,t){"use strict";t.r(a);var e=t(0),n=Object(e.a)({},(function(){this._self._c;return this._m(0)}),[function(){var s=this,a=s._self._c;return a("div",{staticClass:"content"},[a("p",[s._v("要在两台Linux服务器之间实现实时文件同步，您可以使用"),a("code",[s._v("rsync")]),s._v("结合"),a("code",[s._v("inotifywait")]),s._v("工具来实现。")]),s._v(" "),a("p",[a("code",[s._v("rsync")]),s._v("用于实现文件的同步，而"),a("code",[s._v("inotifywait")]),s._v("用于监视文件系统的更改事件。当文件发生更改时，"),a("code",[s._v("inotifywait")]),s._v("会触发一个事件，然后您可以使用"),a("code",[s._v("rsync")]),s._v("来将更改的文件同步到另一台服务器。")]),s._v(" "),a("p",[s._v("以下是一个示例的脚本，使用"),a("code",[s._v("rsync")]),s._v("和"),a("code",[s._v("inotifywait")]),s._v("实现实时文件同步：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SOURCE_DIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/path/to/source"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DESTINATION_DIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/path/to/destination"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REMOTE_SERVER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user@remote-server"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动inotifywait监视源目录的文件更改事件")]),s._v("\ninotifywait "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" modify,create,delete,move "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${SOURCE_DIR}")]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" directory event "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构建目标文件路径")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("destination_file")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${DESTINATION_DIR}")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${directory"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("#")]),s._v("${SOURCE_DIR}")]),s._v("}/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${file}")]),s._v('"')]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用rsync将更改的文件同步到目标服务器")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-avz")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--delete")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${directory}")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${file}")]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${REMOTE_SERVER}")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${destination_file}")]),s._v('"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("将上述脚本中的"),a("code",[s._v("/path/to/source")]),s._v("替换为源目录的路径，"),a("code",[s._v("/path/to/destination")]),s._v("替换为目标目录的路径，"),a("code",[s._v("user@remote-server")]),s._v("替换为远程服务器的用户名和地址。")]),s._v(" "),a("p",[s._v("这个脚本将监视源目录的文件更改事件，并使用"),a("code",[s._v("rsync")]),s._v("将更改的文件同步到目标目录。请确保在运行脚本之前安装了"),a("code",[s._v("rsync")]),s._v("和"),a("code",[s._v("inotify-tools")]),s._v("软件包。")]),s._v(" "),a("p",[s._v("请注意，实时文件同步可能会对系统资源产生一定的负载，因此请根据实际情况调整监视的频率和同步的方式。另外，建议在执行实时文件同步之前进行备份，以防止意外情况发生。")]),s._v(" "),a("p",[s._v("要在使用"),a("code",[s._v("inotifywait")]),s._v("监视目录时忽略特定的子目录和文件，您可以使用"),a("code",[s._v("--exclude")]),s._v("选项来指定要忽略的模式。")]),s._v(" "),a("p",[s._v("以下是一个示例，演示如何使用"),a("code",[s._v("inotifywait")]),s._v("忽略特定的子目录和文件：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SOURCE_DIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/path/to/source"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("EXCLUDE_PATTERN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"subdir1|subdir2|file1.txt"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动inotifywait监视源目录的文件更改事件，忽略指定的子目录和文件")]),s._v("\ninotifywait "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--exclude")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${EXCLUDE_PATTERN}")]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" modify,create,delete,move "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${SOURCE_DIR}")]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" directory event "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 处理文件更改事件")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Detected change in '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${directory}")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${file}")]),s._v('"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进行其他操作...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("在上述示例中，将"),a("code",[s._v("/path/to/source")]),s._v("替换为您要监视的源目录的路径。"),a("code",[s._v("subdir1|subdir2|file1.txt")]),s._v("是一个正则表达式模式，用于指定要忽略的子目录和文件。您可以根据需要修改模式。")]),s._v(" "),a("p",[s._v("通过使用"),a("code",[s._v("--exclude")]),s._v("选项并指定要忽略的模式，"),a("code",[s._v("inotifywait")]),s._v("将忽略匹配模式的子目录和文件的更改事件。")]),s._v(" "),a("p",[s._v("请注意，"),a("code",[s._v("--exclude")]),s._v("选项使用的是基于正则表达式的模式匹配，因此您可以根据需要使用更复杂的模式来匹配要忽略的子目录和文件。")])])}],!1,null,null,null);a.default=n.exports}}]);